<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fantasy EFMO</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glass { background: linear-gradient(135deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)); }
    .injury { color: #fff; background: #ef4444; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; }
    .available { color: #fff; background: #10b981; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; }
    .doubt { color: #000; background: #facc15; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; }
    .score-badge { display: inline-block; min-width: 24px; text-align: center; padding: 2px 4px; border-radius: 4px; font-size: 0.75rem; font-weight: 500; margin-right: 2px; }
    .score-red { background-color: #ff3200; color: #000; }
    .score-gray { background-color: #d6d6d6; color: #000; }
    .score-yellow { background-color: #ffff42; color: #000; }
    .score-green { background-color: #23d750; color: #000; }
    .score-blue { background-color: #4bffff; color: #000; }
    .cursor-pointer { cursor: pointer; }
  </style>
</head>
<body class="bg-slate-900 text-slate-100 antialiased">
  <div class="max-w-6xl mx-auto p-6">
    <header class="flex items-center justify-between mb-6">
      <div>
        <h1 class="text-2xl font-extrabold">E.F.M.O. Boadilla 'B'</h1>
        <p class="text-slate-400 text-sm">Puntos, estadísticas, y mucho más</p>
      </div>
    </header>

    <main class="grid lg:grid-cols-3 gap-6">
      <section class="glass p-4 rounded-lg lg:col-span-1">
        <h2 class="font-semibold mb-3">Resumen</h2>
        <div class="space-y-3">
          <div class="flex items-center justify-between">
            <div class="text-sm text-slate-400">Jugadores</div>
            <div id="playerCount" class="font-bold">0</div>
          </div>
          <div class="flex items-center justify-between">
            <div class="text-sm text-slate-400">Lesionados</div>
            <div id="injuredCount" class="font-bold">0</div>
          </div>
        </div>

        <hr class="my-4 border-slate-700"/>
        <h3 class="font-semibold mb-2">Filtros</h3>
        <div class="space-y-2">
          <select id="positionFilter" class="w-full p-2 bg-slate-800 rounded">
            <option value="all">Todas las posiciones</option>
            <option value="Portero">Portero</option>
            <option value="Defensa">Defensa</option>
            <option value="Centrocampista">Centrocampista</option>
            <option value="Delantero">Delantero</option>
          </select>

          <select id="statusFilter" class="w-full p-2 bg-slate-800 rounded">
            <option value="all">Todos los estados</option>
            <option value="available">Disponible</option>
            <option value="injured">Lesionado</option>
            <option value="doubt">Duda</option>
          </select>
        </div>

        <hr class="my-4 border-slate-700"/>
        <h3 class="font-semibold mb-2">Noticias / Lesiones</h3>
        <div id="injuryFeed" class="space-y-3 text-sm text-slate-300"></div>
      </section>

      <section class="lg:col-span-2">
        <div id="playerList" class="glass p-3 rounded-lg overflow-hidden">
          <div id="gridView" class="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 mt-3"></div>
        </div>
      </section>
    </main>

    <div id="statModal" class="fixed inset-0 hidden items-center justify-center bg-black/50">
      <div class="bg-slate-800 rounded-lg w-11/12 max-w-2xl p-4">
        <div class="flex items-start justify-between">
          <h3 id="modalName" class="text-xl font-bold">Nombre jugador</h3>
          <button id="closeModal" class="text-slate-400">Cerrar ✕</button>
        </div>
        <div class="mt-3 text-sm text-slate-300 grid grid-cols-2 gap-3">
          <div><strong>Puntos:</strong> <span id="modalPoints">0</span></div>
          <div><strong>Minutos:</strong> <span id="modalMinutes">0</span></div>
          <div><strong>Goles:</strong> <span id="modalGoals">0</span></div>
          <div><strong>Asistencias:</strong> <span id="modalAssists">0</span></div>
          <div><strong>Tarjetas:</strong> <span id="modalCards">0</span></div>
          <div><strong>Partidos:</strong> <span id="modalMatches">0</span></div>
        </div>
        <div class="mt-4 text-sm text-slate-400">Últimas actuaciones</div>
        <div id="modalPerformances" class="mt-2 space-y-2 text-slate-300 text-xs"></div>
      </div>
    </div>
  </div>

  <script>
    const players = [
      { id:1, name:'Iker Martínez', pos:'Portero', status:'available', performances:[
        {points:10, minutes:90, goals:0, assists:0, cards:0, comment:'Buen partido'},
        {points:12, minutes:90, goals:0, assists:0, cards:0, comment:''},
        {points:10, minutes:90, goals:0, assists:0, cards:0, comment:'Excelente'},
        {points:-2, minutes:45, goals:0, assists:0, cards:1, comment:'Mal partido'}
      ]},
      { id:2, name:'Carlos Vega', pos:'Defensa', status:'doubt', performances:[
        {points:6, minutes:90, goals:0, assists:0, cards:0, comment:''},
        {points:5, minutes:90, goals:0, assists:0, cards:0, comment:''},
        {points:7, minutes:90, goals:0, assists:0, cards:1, comment:''}
      ]},
      { id:3, name:'Luis Romero', pos:'Centrocampista', status:'available', performances:[
        {points:14, minutes:90, goals:1, assists:1, cards:0, comment:'Muy activo'},
        {points:15, minutes:90, goals:1, assists:2, cards:0, comment:'Gran asistencia'},
        {points:16, minutes:90, goals:1, assists:1, cards:0, comment:''}
      ]}
    ];

    function renderScoreBadge(score){
      if(score<0) return `<span class='score-badge score-red'>${score}</span>`;
      if(score===0) return `<span class='score-badge score-gray'>${score}</span>`;
      if(score>=1 && score<=4) return `<span class='score-badge score-yellow'>${score}</span>`;
      if(score>=5 && score<=9) return `<span class='score-badge score-green'>${score}</span>`;
      return `<span class='score-badge score-blue'>${score}</span>`;
    }

    function renderStatusBadge(p){
      if(p.status==='injured') return `<span class='injury'>Lesionado</span>`;
      if(p.status==='doubt') return `<span class='doubt'>Duda</span>`;
      return `<span class='available'>Disponible</span>`;
    }

    function calculateTotals(perfs){
      return perfs.reduce((acc, p) => {
        acc.points += p.points;
        acc.minutes += p.minutes;
        acc.goals += p.goals;
        acc.assists += p.assists;
        acc.cards += p.cards;
        return acc;
      }, {points:0, minutes:0, goals:0, assists:0, cards:0});
    }

    function render(){
      const grid=document.getElementById('gridView');
      const posFilter=document.getElementById('positionFilter').value;
      const statusFilter=document.getElementById('statusFilter').value;

      grid.innerHTML='';
      const filtered = players.filter(p=>{
        const posOk = posFilter==='all' || p.pos===posFilter;
        const statusOk = statusFilter==='all' || p.status===statusFilter;
        return posOk && statusOk;
      });

      filtered.forEach(p=>{
        const totals = calculateTotals(p.performances);
        const lastThree = p.performances.slice(-3);
        const card=document.createElement('div');
        card.className='p-3 bg-slate-800 rounded-lg cursor-pointer';
        card.setAttribute('data-id',p.id);
        card.innerHTML=`
          <div class='flex items-start justify-between'>
            <div><div class='text-sm text-slate-400'>${p.pos}</div><div class='font-semibold'>${p.name}</div></div>
            <div class='text-right'><div class='text-xs text-slate-400'>Puntos</div><div class='text-lg font-bold'>${totals.points}</div></div>
          </div>
          <div class='mt-3'>${lastThree.map(perf => renderScoreBadge(perf.points)).join(' ')}</div>
          <div class='mt-2'>${renderStatusBadge(p)}</div>
        `;
        card.onclick = ()=>openModal(p.id);
        grid.appendChild(card);
      });

      document.getElementById('playerCount').textContent = filtered.length;
      document.getElementById('injuredCount').textContent = players.filter(p=>p.status==='injured').length;
    }

    function openModal(id){
      const p=players.find(x=>x.id===id); if(!p) return;
      const totals = calculateTotals(p.performances);
      document.getElementById('modalName').textContent=p.name;
      document.getElementById('modalPoints').textContent=totals.points;
      document.getElementById('modalMinutes').textContent=totals.minutes;
      document.getElementById('modalGoals').textContent=totals.goals;
      document.getElementById('modalAssists').textContent=totals.assists;
      document.getElementById('modalCards').textContent=totals.cards;
      document.getElementById('modalMatches').textContent=p.performances.length;

      const perfDiv=document.getElementById('modalPerformances');
      perfDiv.innerHTML='';
      // Mostrar todas las jornadas
      p.performances.forEach((perf,i)=>{
        const div=document.createElement('div');
        div.className='p-2 bg-slate-700 rounded flex justify-between items-center';
        div.innerHTML=`<span>Jornada ${i+1}: ${renderScoreBadge(perf.points)}</span><span>${perf.comment}</span>`;
        perfDiv.appendChild(div);
      });

      document.getElementById('statModal').classList.remove('hidden');
      document.getElementById('statModal').classList.add('flex');
    }

    document.getElementById('positionFilter').addEventListener('change', render);
    document.getElementById('statusFilter').addEventListener('change', render);
    document.getElementById('closeModal').addEventListener('click',()=>{
      document.getElementById('statModal').classList.add('hidden'); 
      document.getElementById('statModal').classList.remove('flex');
    });

    render();
  </script>
</body>
</html>

